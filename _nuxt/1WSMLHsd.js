const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./B2rPFScv.js","./Dutgce-t.js","./BBoprNr9.js","./CBsAYBMq.js","./DGB6o809.js","./DENk7BAX.js","./NcfOxGOJ.js","./Db2rOhY5.js","./Ba_gg6Bw.js","./1jRA9jIJ.js","./DCo6-o3V.js","./BNCPP-Lc.js","./BAiuiMj1.js","./C3jLKcSw.js","./CiY_2Xgg.js","./Cc173s93.js","./BIaPAw8G.js","./DYcbPNs3.js","./D391rXv1.js","./CKUT-AdB.js","./DSor2vHC.js","./MGqbFZfO.js","./DO_F0CpN.js","./C1H55nfk.js","./BD0SBfHH.js","./jYV8uuws.js","./_zC-pxp2.js","./WJtrQfu8.js","./eOprcJGM.js","./A64qX3LD.js","./CviRnRtU.js","./B_lKjAkS.js","./XjPU5nHJ.js","./CHpdm47R.js","./DznvR31K.js","./C3uZdvdz.js"])))=>i.map(i=>d[i]);
import{_ as me,r as m,K as F,c as h,o as v,a as s,F as x,J,n as Ve,e as q,H as P,t as c,C as xe,ah as _,M as Pe,A as ke,ag as Ee,W as Se,f as de,D as Ae,w as d,b as u,ai as Le,d as T}from"./X6HiR9a0.js";import{_ as qe}from"./BQfR9M6c.js";import{V as ge}from"./QTtvbP9O.js";import{l as Ie}from"./BbohOuBu.js";import{A as ce}from"./CUcIaLN8.js";import{a as z,V as D}from"./Cmx4BhuN.js";import{V as Ce}from"./DhWIIRAe.js";import{V as Te,a as De,b as Oe}from"./CDWtWOpw.js";import{V as H}from"./D8k_Q558.js";import{l as ve,q as fe}from"./DKX_newj.js";import{V as _e,a as pe}from"./CGimk7xp.js";import{V as Re}from"./DDsi7qit.js";import"./CPQ6r5fr.js";const $e={class:"status-selector-container"},ze={class:"status-selector"},Fe=["onClick"],Me={class:"status-label"},We={__name:"StatusSelector",props:{modelValue:{type:Array,default:()=>[]},options:{type:Array,default:()=>[{label:"規劃中",value:"規劃中",color:"#a5b4fc"},{label:"辦理中",value:"辦理中",color:"#fdba74"},{label:"已完成",value:"已完成",color:"#f87171"}]}},emits:["update:modelValue","filter"],setup(M,{emit:n}){const I=M,b=n,g=m(I.modelValue);F(()=>I.modelValue,w=>{g.value=w});const C=w=>{const E=g.value.indexOf(w);E===-1?g.value.push(w):g.value.splice(E,1),b("update:modelValue",g.value),b("filter",g.value)};return(w,E)=>(v(),h("div",$e,[s("div",ze,[(v(!0),h(x,null,J(M.options,V=>(v(),h("div",{key:V.value,class:Ve(["status-item d-flex align-center justify-center ga-1",{"status-selected":g.value.includes(V.value)}]),onClick:W=>C(V.value)},[g.value.includes(V.value)?(v(),q(ge,{key:0,class:"status-check-icon",icon:"mdi-check-circle-outline"})):P("",!0),s("span",Me,c(V.label),1)],10,Fe))),128))])]))}},Ne=me(We,[["__scopeId","data-v-629e5361"]]),je={class:"lightbox-pagination"},Be={class:"map-filters d-none d-md-block"},Ue={class:"map-filters-mobile d-md-none"},He={key:0,class:"empty-selection"},Je={class:"empty-icon"},Ge={class:"empty-title"},Ke={class:"empty-subtitle"},Ye={key:1},Ze={class:"location-header"},Xe={class:"location-text text-white"},Qe={class:"project-title"},et={class:"status-chip"},tt={class:"info-grid"},at={class:"info-value"},lt={class:"info-value"},st={class:"info-value"},nt={class:"info-value"},ot={class:"info-value"},it={class:"info-value"},rt={class:"info-value"},ut={class:"progress-container"},dt={class:"text-white",style:{"text-shadow":"0 0 2px rgba(0,0,0,0.7)",opacity:"1"}},ct={class:"info-value"},vt={class:"progress-container"},ft={class:"text-white",style:{"text-shadow":"0 0 2px rgba(0,0,0,0.7)",opacity:"1"}},_t={class:"info-value full-width-value"},pt={class:"image-grid"},mt={class:"info-value full-width-value"},gt={class:"image-grid"},ht={class:"info-value"},yt={class:"button-group"},wt={__name:"map",setup(M){const n=ke(),I=Ae(),b=t=>!t||typeof t!="string"?"":t.replace(/[<>'"&]/g,e=>({"<":"&lt;",">":"&gt;","'":"&#x27;",'"':"&quot;","&":"&amp;"})[e]||e).trim().slice(0,100),g=m(!1),C=m([]),w=m(0);let E,V,W,G,K,Y,S,Z,X,Q,ee,te,ae,le;xe(async()=>{E=(await _(async()=>{const{default:a}=await import("./B2rPFScv.js");return{default:a}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]),import.meta.url)).default,V=(await _(async()=>{const{default:a}=await import("./Db2rOhY5.js").then(i=>i.e);return{default:a}},__vite__mapDeps([7,2,3,6,8,9,10,11,12,13,14,15]),import.meta.url)).default,W=(await _(async()=>{const{default:a}=await import("./eOprcJGM.js");return{default:a}},__vite__mapDeps([28,29,4,3,5,10,9,8,11,13,6,20,30,17,23,7,2,12,14,15]),import.meta.url)).default,G=(await _(async()=>{const{default:a}=await import("./B_lKjAkS.js");return{default:a}},__vite__mapDeps([31,9,8,20,29,4,3,5,10,11,13,6,32,2]),import.meta.url)).default,K=(await _(async()=>{const{default:a}=await import("./CHpdm47R.js");return{default:a}},__vite__mapDeps([33,2,3,6]),import.meta.url)).default,Y=(await _(async()=>{const{default:a}=await import("./BAiuiMj1.js").then(i=>i.b);return{default:a}},__vite__mapDeps([12,9,8,3,2,13,6,14]),import.meta.url)).default,{fromLonLat:S}=await _(()=>import("./1jRA9jIJ.js").then(a=>a.a5),__vite__mapDeps([9,8]),import.meta.url),Z=(await _(async()=>{const{default:a}=await import("./DznvR31K.js");return{default:a}},__vite__mapDeps([34,7,2,3,6,8,9,10,11,12,13,14,15,4,23,16,17,18,19,20,21,22,30,26,24,25,27]),import.meta.url)).default,X=(await _(async()=>{const{default:a}=await import("./C3uZdvdz.js");return{default:a}},__vite__mapDeps([35,1,2,3,6,9,8,15,11,14,13,25,32]),import.meta.url)).default,Q=(await _(async()=>{const{default:a}=await import("./BIaPAw8G.js").then(i=>i.y);return{default:a}},__vite__mapDeps([16,6,17,4,3,8,18,2,19,20,21,22]),import.meta.url)).default,ee=(await _(async()=>{const{default:a}=await import("./_zC-pxp2.js");return{default:a}},__vite__mapDeps([26,17,4,3,8,6,18,19,20]),import.meta.url)).default,te=(await _(async()=>{const{default:a}=await import("./WJtrQfu8.js");return{default:a}},__vite__mapDeps([27,20,21,17,4,3,8,18]),import.meta.url)).default,ae=(await _(async()=>{const{default:a}=await import("./MGqbFZfO.js");return{default:a}},__vite__mapDeps([21,17,4,3,8,18]),import.meta.url)).default,le=(await _(async()=>{const{default:a}=await import("./DO_F0CpN.js");return{default:a}},[],import.meta.url)).default,p.value=we(),Pe(()=>{(n&&n.query&&n.query.search||n&&n.query&&n.query.region)&&U()});const t=n&&n.query&&n.query.id,e=n&&n.query&&n.query.search,r=n&&n.query&&n.query.region;if(t){const a=R.value.find(i=>i.id===parseInt(t));a&&ie(a)}else(e||r)&&re();window.addEventListener("resize",()=>{p.value&&p.value.updateSize()})}),Ee(()=>{window.removeEventListener("resize",()=>{}),p.value&&(p.value.setTarget(null),p.value=null)});const se=m(null),p=m(null),k=m(null),ne=m([]),{mdAndUp:O}=Se(),N=[{label:"規劃中",value:"規劃中",color:"#a5b4fc"},{label:"辦理中",value:"辦理中",color:"#fdba74"},{label:"已完成",value:"已完成",color:"#f87171"}],j=m(null),oe=m(null),y=m([]),R=m(Ie.filter(t=>t.id&&t.name&&t.longitude&&t.latitude&&typeof t.longitude=="number"&&typeof t.latitude=="number").map(t=>({id:t.id,name:t.name,township:t.township,county:"宜蘭縣",method:t.developmentMethod,status:t.processingStatus,coordinates:[t.longitude,t.latitude],area:t.totalArea,timeline:t.timeline,organizer:"宜蘭縣政府",planningScope:t.planningScope,constructionProgress:t.constructionProgress||0,estimatedProgress:t.estimatedProgress||0,siteCondition:t.siteCondition||[],aerialPhoto:t.aerialPhoto||[],preliminaryWork:t.preliminaryWork||[],planApproval:t.planApproval||[]}))),A=de(()=>{let t=[...R.value];const e=n&&n.query&&n.query.search,r=n&&n.query&&n.query.region;if(e){const a=b(e);if(a){const i=a.toLowerCase();t=t.filter(o=>o.name.toLowerCase().includes(i)||o.township.toLowerCase().includes(i))}}if(r){const a=b(r);ce.includes(a)&&(t=t.filter(i=>i.township===a))}return oe.value&&(t=t.filter(a=>a.status===oe.value)),y.value&&y.value.length>0&&(t=t.filter(a=>y.value.includes(a.status))),t}),l=m(null),B=de(()=>{const t=n&&n.query&&n.query.search||n&&n.query&&n.query.region,e=A.value.length>0;return t&&!e?"no-results":!l.value&&e?"no-selection":!l.value&&!t?"initial":"selected"}),ie=t=>{l.value=t,I.push({path:n.path,query:{...n.query||{},id:t.id}}),k.value&&k.value.changed(),p.value&&p.value.getView().animate({center:S(t.coordinates),zoom:O.value?15:14,duration:1e3})},re=()=>{A.value.length===0&&(l.value=null)},he=()=>{switch(B.value){case"no-results":return"查無相關開發案";case"no-selection":return"請先選擇開發案";default:return"請先選擇開發案"}},ye=()=>{switch(B.value){case"no-results":{const t=b(n&&n.query&&n.query.search),e=b(n&&n.query&&n.query.region);let r="找不到符合條件的開發案";const a=[];if(t&&e?a.push(`「${t}」在「${e}」`):t?a.push(`「${t}」`):e&&a.push(`「${e}」`),y.value&&y.value.length>0){const i=y.value.map(o=>{const f=N.find(L=>L.value===o);return f?f.label:o}).join("、");a.push(`狀態「${i}」`)}return a.length>0&&(r+=`：${a.join("，")}`),r+"，請調整搜尋條件"}case"no-selection":return"點擊地圖上的標記以查看詳細資訊";default:return"點擊地圖上的標記以查看詳細資訊"}},$=t=>{if(!(!t||t.length===0)){if(t.length===1&&(t[0].type==="pdf"||typeof t[0]=="string"&&t[0].includes(".pdf"))){window.open(t[0].url||t[0],"_blank");return}C.value=t.map(e=>typeof e=="string"?{src:e}:{src:e.url||e.src||e,title:e.title||""}),w.value=0,g.value=!0}},ue=()=>{U()},U=()=>{if(!(!p.value||!k.value)&&(k.value.changed(),!l.value)){const t=ne.value.filter(e=>{const r=e.get("data");return A.value.some(a=>a.id===r.id)});if(t.length>0){const e=t.reduce((r,a)=>{const o=a.getGeometry().getExtent();return r?[Math.min(r[0],o[0]),Math.min(r[1],o[1]),Math.max(r[2],o[2]),Math.max(r[3],o[3])]:o},null);e&&p.value.getView().fit(e,{padding:[100,50,50,50],maxZoom:22,duration:1e3})}else p.value.getView().animate({center:S([121.76,24.75]),zoom:O.value?12:10,duration:1e3})}},we=()=>{const t=R.value.map(i=>new K({geometry:new Y(S(i.coordinates)),data:i}));ne.value=t;const e=new X({features:t}),r=new Z({source:e,style:i=>{const o=i.get("data");if(!o||!A.value.some(be=>be.id===o.id))return null;const L=l.value&&l.value.id===o.id;return new Q({image:new ee({src:"icons/marker.png",width:25}),text:new te({text:o.name,offsetY:-20,font:"bold 12px Arial",fill:new ae({color:L?"#f5a623":"#2a2ace"}),stroke:new le({color:"#FFFFFF",width:3}),padding:[3,3,3,3]}),zIndex:L?2:1})}});k.value=r;const a=new E({target:se.value,layers:[new W({source:new G}),r],view:new V({center:S([121.76,24.75]),zoom:O.value?12:10})});return a.on("click",i=>{const o=a.forEachFeatureAtPixel(i.pixel,f=>f);if(o){const f=o.get("data");f&&ie(f)}}),a};return F(A,()=>{if(U(),l.value&&!A.value.some(t=>t.id===l.value.id)){l.value=null;const t={...n.query};delete t.id,I.push({path:n.path,query:t})}re()},{deep:!0}),F(l,()=>{k.value&&k.value.changed()}),F(()=>n&&n.query?n.query:{},(t,e)=>{if(t=t||{},e=e||{},JSON.stringify(t)!==JSON.stringify(e)){const r=t.id,a=t.region;if(r&&r!==e.id){const o=R.value.find(f=>f.id===parseInt(r));o&&(l.value=o,p.value&&p.value.getView().animate({center:S(o.coordinates),zoom:O.value?15:14,duration:1e3}))}const i=b(a);i?ce.includes(i)?j.value=i:j.value=null:!t.region&&e.region&&(j.value=null),!r&&!t.search&&!t.region&&(e.id||e.search||e.region)&&(l.value=null)}},{immediate:!0}),(t,e)=>{const r=Le("vue-easy-lightbox"),a=qe,i=Ne;return v(),q(Re,{fluid:"",class:"pa-0"},{default:d(()=>[u(a,null,{default:d(()=>[u(r,{visible:g.value,imgs:C.value,index:w.value,onHide:e[0]||(e[0]=o=>g.value=!1)},{pagination:d(()=>[s("div",je,c(w.value+1)+" / "+c(C.value.length),1)]),_:1},8,["visible","imgs","index"])]),_:1}),u(D,{"no-gutters":"",class:"land-development-container"},{default:d(()=>[u(z,{cols:"12",md:"6",class:"map-section"},{default:d(()=>[s("div",{ref_key:"mapElement",ref:se,class:"map-element"},null,512),s("div",Be,[u(i,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=o=>y.value=o),options:N,onFilter:ue},null,8,["modelValue"])]),s("div",Ue,[u(i,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=o=>y.value=o),options:N,onFilter:ue},null,8,["modelValue"])])]),_:1}),u(z,{cols:"12",md:"6",class:"info-section pa-5"},{default:d(()=>[l.value?(v(),h("div",Ye,[s("div",Ze,[s("div",null,[s("span",Xe,c(l.value.county)+" | "+c(l.value.township),1)])]),s("h1",Qe,c(l.value.name),1),s("div",et,[u(Ce,{class:"bg-white",color:"orange",size:t.$vuetify.display.mdAndUp?"default":"small"},{default:d(()=>[T(c(l.value.status),1)]),_:1},8,["size"])]),u(Te,{class:"mt-4"},{default:d(()=>[u(De,{class:"info-title"},{default:d(()=>[e[7]||(e[7]=T(" 基本資訊 ")),u(H,{class:"mt-2"})]),_:1}),u(Oe,null,{default:d(()=>[s("div",tt,[e[15]||(e[15]=s("div",{class:"info-label"}," 土地開發名稱： ",-1)),s("div",at,c(l.value.name),1),e[16]||(e[16]=s("div",{class:"info-label"}," 鄉鎮市區： ",-1)),s("div",lt,c(l.value.township),1),e[17]||(e[17]=s("div",{class:"info-label"}," 開發方式： ",-1)),s("div",st,c(l.value.method),1),e[18]||(e[18]=s("div",{class:"info-label"}," 辦理情形： ",-1)),s("div",nt,c(l.value.status),1),e[19]||(e[19]=s("div",{class:"info-label"}," 開發總面積： ",-1)),s("div",ot,c(l.value.area)+" 公頃 ",1),e[20]||(e[20]=s("div",{class:"info-label"}," 開發期程： ",-1)),s("div",it,c(l.value.timeline),1),e[21]||(e[21]=s("div",{class:"info-label"}," 主辦單位： ",-1)),e[22]||(e[22]=s("div",{class:"info-value"}," 宜蘭縣政府 ",-1)),l.value.constructionProgress!==void 0?(v(),h(x,{key:0},[e[8]||(e[8]=s("div",{class:"info-label"}," 施工進度： ",-1)),s("div",rt,[s("div",ut,[u(ve,{"model-value":l.value.constructionProgress,color:"primary",height:"20",rounded:"",class:"mb-1"},{default:d(({value:o})=>[s("strong",dt,c(Math.ceil(o))+"%",1)]),_:1},8,["model-value"])])])],64)):P("",!0),l.value.estimatedProgress!==void 0?(v(),h(x,{key:1},[e[9]||(e[9]=s("div",{class:"info-label"}," 預估進度： ",-1)),s("div",ct,[s("div",vt,[u(ve,{"model-value":l.value.estimatedProgress,color:"secondary",height:"20",rounded:"",class:"mb-1"},{default:d(({value:o})=>[s("strong",ft,c(Math.ceil(o))+"%",1)]),_:1},8,["model-value"])])])],64)):P("",!0),l.value.siteCondition&&l.value.siteCondition.length>0?(v(),h(x,{key:2},[e[10]||(e[10]=s("div",{class:"info-label full-width-label"}," 基地現況 ",-1)),s("div",_t,[u(H,{class:"mb-3"}),s("div",pt,[u(D,{class:"mb-2"},{default:d(()=>[(v(!0),h(x,null,J(l.value.siteCondition.slice(0,2),(o,f)=>(v(),q(z,{key:f,cols:"6",sm:"6",md:"6",class:"pa-1"},{default:d(()=>[u(fe,{src:o,alt:`基地現況 ${f+1}`,height:"120",cover:"",class:"rounded cursor-pointer",onClick:e[3]||(e[3]=L=>$(l.value.siteCondition))},{placeholder:d(()=>[u(D,{class:"fill-height ma-0",align:"center",justify:"center"},{default:d(()=>[u(pe,{size:"20",indeterminate:"",color:"grey-lighten-5"})]),_:1})]),_:2},1032,["src","alt"])]),_:2},1024))),128))]),_:1})])])],64)):P("",!0),l.value.aerialPhoto&&l.value.aerialPhoto.length>0?(v(),h(x,{key:3},[e[11]||(e[11]=s("div",{class:"info-label full-width-label"}," 空拍圖 ",-1)),s("div",mt,[u(H,{class:"mb-3"}),s("div",gt,[u(D,{class:"mb-2"},{default:d(()=>[(v(!0),h(x,null,J(l.value.aerialPhoto.slice(0,2),(o,f)=>(v(),q(z,{key:f,cols:"6",sm:"6",md:"6",class:"pa-1"},{default:d(()=>[u(fe,{src:o,alt:`空拍圖 ${f+1}`,height:"120",cover:"",class:"rounded cursor-pointer",onClick:e[4]||(e[4]=L=>$(l.value.aerialPhoto))},{placeholder:d(()=>[u(D,{class:"fill-height ma-0",align:"center",justify:"center"},{default:d(()=>[u(pe,{size:"20",indeterminate:"",color:"grey-lighten-5"})]),_:1})]),_:2},1032,["src","alt"])]),_:2},1024))),128))]),_:1})])])],64)):P("",!0),l.value.preliminaryWork&&l.value.preliminaryWork.length>0||l.value.planApproval&&l.value.planApproval.length>0?(v(),h(x,{key:4},[e[14]||(e[14]=s("div",{class:"info-label"}," 相關資料： ",-1)),s("div",ht,[s("div",yt,[l.value.preliminaryWork&&l.value.preliminaryWork.length>0?(v(),q(_e,{key:0,color:"primary",size:"small",class:"mr-2 mb-2",onClick:e[5]||(e[5]=o=>$(l.value.preliminaryWork))},{default:d(()=>e[12]||(e[12]=[T(" 先行作業 ")])),_:1})):P("",!0),l.value.planApproval&&l.value.planApproval.length>0?(v(),q(_e,{key:1,color:"primary",size:"small",class:"mb-2",onClick:e[6]||(e[6]=o=>$(l.value.planApproval))},{default:d(()=>e[13]||(e[13]=[T(" 計劃核准 ")])),_:1})):P("",!0)])])],64)):P("",!0)])]),_:1})]),_:1})])):(v(),h("div",He,[s("div",Je,[u(ge,{size:"80",color:"white"},{default:d(()=>[T(c(B.value==="no-results"?"mdi-magnify-close":"mdi-map-marker-outline"),1)]),_:1})]),s("h2",Ge,c(he()),1),s("p",Ke,c(ye()),1)]))]),_:1})]),_:1})]),_:1})}}},Dt=me(wt,[["__scopeId","data-v-8b53a6db"]]);export{Dt as default};
