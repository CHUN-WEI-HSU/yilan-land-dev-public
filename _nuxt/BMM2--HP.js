import{D as ue,E as ie,F as re,G as K,H as Se,I as de,z as l,J as Ie,K as we,L as E,M as ce,j as S,N as Z,r as h,O as xe,Q as De,R as ze,S as j,T as Fe,U as Be,_ as he,V as ee,o as Te,t as le,A as o,W as Ae,X as Re,v as U,B as F,Y as te,y as H,Z as _e,x as ae,C as J,$ as Ue}from"./D0UG6bZz.js";import{u as $e}from"./BUYRWAkO.js";import{V as qe,a as Le,b as Me}from"./BgYkF0es.js";import{V as B,a as Ne,b as Ee,c as je,d as Oe,e as Ge}from"./RquQ-slm.js";import{V as He}from"./CCzQCRnO.js";import{V as Je}from"./CEkwgJIC.js";import{V as N,a as v}from"./B0NSncsH.js";import{u as Ke,V as ne,a as oe,m as Qe,b as We,c as Xe,d as y,e as Ye}from"./CRkk4VS1.js";import{u as Ze,a as el,m as ll,b as tl,c as al,V as me,d as nl}from"./CLZtlTzD.js";import{c as ol,u as sl,a as ul,b as il,d as rl,e as dl,f as cl,m as ml,g as fl,h as vl,i as pl,j as Vl,k as yl,l as bl,V as se}from"./CSi8b4_d.js";import{f as gl}from"./CTPaVv7G.js";import{V as kl}from"./CFD_vZoV.js";import"./UBcuvIsH.js";const Cl=ol("v-alert-title"),Pl=["success","info","warning","error"],Sl=ie({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:we,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>Pl.includes(e)},...al(),...yl(),...tl(),...Vl(),...pl(),...vl(),...fl(),...ll(),...Ie(),...ml({variant:"flat"})},"VAlert"),Il=ue()({name:"VAlert",props:Sl(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,g){let{emit:I,slots:u}=g;const c=re(e,"modelValue"),V=K(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),{themeClasses:m}=Se(e),{colorClasses:p,colorStyles:D,variantClasses:T}=sl(()=>({color:e.color??e.type,variant:e.variant})),{densityClasses:f}=ul(e),{dimensionStyles:s}=Ze(e),{elevationClasses:d}=il(e),{locationStyles:w}=rl(e),{positionClasses:A}=dl(e),{roundedClasses:z}=cl(e),{textColorClasses:i,textColorStyles:t}=el(()=>e.borderColor),{t:n}=de(),k=K(()=>({"aria-label":n(e.closeLabel),onClick(b){c.value=!1,I("click:close",b)}}));return()=>{const b=!!(u.prepend||V.value),R=!!(u.title||e.title),O=!!(u.close||e.closable);return c.value&&l(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},m.value,p.value,f.value,d.value,A.value,z.value,T.value,e.class],style:[D.value,s.value,w.value,e.style],role:"alert"},{default:()=>{var $,q;return[bl(!1,"v-alert"),e.border&&l("div",{key:"border",class:["v-alert__border",i.value],style:t.value},null),b&&l("div",{key:"prepend",class:"v-alert__prepend"},[u.prepend?l(se,{key:"prepend-defaults",disabled:!V.value,defaults:{VIcon:{density:e.density,icon:V.value,size:e.prominent?44:28}}},u.prepend):l(me,{key:"prepend-icon",density:e.density,icon:V.value,size:e.prominent?44:28},null)]),l("div",{class:"v-alert__content"},[R&&l(Cl,{key:"title"},{default:()=>{var x;return[((x=u.title)==null?void 0:x.call(u))??e.title]}}),(($=u.text)==null?void 0:$.call(u))??e.text,(q=u.default)==null?void 0:q.call(u)]),u.append&&l("div",{key:"append",class:"v-alert__append"},[u.append()]),O&&l("div",{key:"close",class:"v-alert__close"},[u.close?l(se,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var x;return[(x=u.close)==null?void 0:x.call(u,{props:k.value})]}}):l(B,E({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},k.value),null)])]}})}}}),wl=ie({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},...We({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>ce(e).every(g=>g!=null&&typeof g=="object")},...Qe({clearable:!0})},"VFileInput"),xl=ue()({name:"VFileInput",inheritAttrs:!1,props:wl(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,g){let{attrs:I,emit:u,slots:c}=g;const{t:V}=de(),m=re(e,"modelValue",e.modelValue,a=>ce(a),a=>!e.multiple&&Array.isArray(a)?a[0]:a),{isFocused:p,focus:D,blur:T}=Ke(e),f=S(()=>typeof e.showSize!="boolean"?e.showSize:void 0),s=S(()=>(m.value??[]).reduce((a,r)=>{let{size:C=0}=r;return a+C},0)),d=S(()=>Z(s.value,f.value)),w=S(()=>(m.value??[]).map(a=>{const{name:r="",size:C=0}=a;return e.showSize?`${r} (${Z(C,f.value)})`:r})),A=S(()=>{var r;const a=((r=m.value)==null?void 0:r.length)??0;return e.showSize?V(e.counterSizeString,a,d.value):V(e.counterString,a)}),z=h(),i=h(),t=h(),n=K(()=>p.value||e.active),k=S(()=>["plain","underlined"].includes(e.variant)),b=xe(!1);function R(){var a;t.value!==document.activeElement&&((a=t.value)==null||a.focus()),p.value||D()}function O(a){var r;(r=t.value)==null||r.click()}function $(a){u("mousedown:control",a)}function q(a){var r;(r=t.value)==null||r.click(),u("click:control",a)}function x(a){a.stopPropagation(),R(),Fe(()=>{m.value=[],Be(e["onClick:clear"],a)})}function fe(a){a.preventDefault(),a.stopImmediatePropagation(),b.value=!0}function ve(a){a.preventDefault(),b.value=!1}function pe(a){var C,L;if(a.preventDefault(),a.stopImmediatePropagation(),b.value=!1,!((L=(C=a.dataTransfer)==null?void 0:C.files)!=null&&L.length)||!t.value)return;const r=new DataTransfer;for(const Q of a.dataTransfer.files)r.items.add(Q);t.value.files=r.files,t.value.dispatchEvent(new Event("change",{bubbles:!0}))}return De(m,a=>{(!Array.isArray(a)||!a.length)&&t.value&&(t.value.value="")}),nl(()=>{const a=!!(c.counter||e.counter),r=!!(a||c.details),[C,L]=ze(I),{modelValue:Q,...Ve}=ne.filterProps(e),ye=oe.filterProps(e);return l(ne,E({ref:z,modelValue:e.multiple?m.value:m.value[0],class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--dragging":b.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":k.value},e.class],style:e.style,"onClick:prepend":O},C,Ve,{centerAffix:!k.value,focused:p.value}),{...c,default:G=>{let{id:M,isDisabled:_,isDirty:W,isReadonly:X,isValid:be}=G;return l(oe,E({ref:i,"prepend-icon":e.prependIcon,onMousedown:$,onClick:q,"onClick:clear":x,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},ye,{id:M.value,active:n.value||W.value,dirty:W.value||e.dirty,disabled:_.value,focused:p.value,error:be.value===!1,onDragover:fe,onDrop:pe}),{...c,default:ge=>{var Y;let{props:{class:ke,...Ce}}=ge;return l(j,null,[l("input",E({ref:t,type:"file",readonly:X.value,disabled:_.value,multiple:e.multiple,name:e.name,onClick:P=>{P.stopPropagation(),X.value&&P.preventDefault(),R()},onChange:P=>{if(!P.target)return;const Pe=P.target;m.value=[...Pe.files??[]]},onDragleave:ve,onFocus:R,onBlur:T},Ce,L),null),l("div",{class:ke},[!!((Y=m.value)!=null&&Y.length)&&!e.hideInput&&(c.selection?c.selection({fileNames:w.value,totalBytes:s.value,totalBytesReadable:d.value}):e.chips?w.value.map(P=>l(kl,{key:P,size:"small",text:P},null)):w.value.join(", "))])])}})},details:r?G=>{var M,_;return l(j,null,[(M=c.details)==null?void 0:M.call(c,G),a&&l(j,null,[l("span",null,null),l(Xe,{active:!!((_=m.value)!=null&&_.length),value:A.value,disabled:e.disabled},c.counter)])])}:void 0})}),gl({},z,i,t)}}),Dl={class:"mt-2"},zl={__name:"[action]",setup(e){const g=Ae(),I=Re(),{showSuccess:u}=$e(),c=S(()=>g.params.id),V=S(()=>!!c.value),m=h(!1),p=h(!1),D=h(null),T=["規劃中","進行中","已完成"],f={name:[i=>!!i||"請輸入土地開發區名稱",i=>i&&i.length<=100||"名稱不可超過100個字元"],required:[i=>!!i||"此欄位為必填"],number:[i=>!i||!isNaN(Number(i))||"請輸入有效的數字"]},s=ee({name:"",township:"",county:"",method:"",status:"規劃中",coordinates:[121,24],area:"",timeline:"",organizer:"",files:[]}),d=ee({name:"",file:null}),w=()=>{!d.file||!d.name||(s.files.push({name:d.name,type:"pdf",size:`${(d.file.size/(1024*1024)).toFixed(1)} MB`}),d.name="",d.file=null)},A=i=>{s.files.splice(i,1)},z=async()=>{if(D.value.validate()){p.value=!0;try{await new Promise(i=>setTimeout(i,500)),u(V.value?"成功更新土地開發區資料":"成功新增土地開發區資料"),I.push("/admin/land-dev")}catch(i){console.error("儲存失敗",i)}finally{p.value=!1}}};return Te(async()=>{if(V.value){p.value=!0;try{await new Promise(i=>setTimeout(i,300)),c.value==="2"&&Object.assign(s,{name:"羅莊",township:"羅東鎮",county:"宜蘭縣",method:"公辦市地重劃",status:"已完成",coordinates:[121.765,24.672],area:"8.3",timeline:"107年3月至109年6月",organizer:"宜蘭縣政府",files:[{name:"羅莊重劃計畫書.pdf",type:"pdf",size:"3.1 MB"}]})}catch(i){console.error("獲取資料失敗",i)}finally{p.value=!1}}}),(i,t)=>(U(),le("div",null,[l(qe,null,{default:o(()=>[l(Le,{class:"d-flex align-center"},{default:o(()=>[l(B,{icon:"mdi-arrow-left",variant:"text",class:"mr-2",onClick:t[0]||(t[0]=n=>te(I).back())}),F(" "+H(V.value?"編輯土地開發區":"新增土地開發區"),1)]),_:1}),l(Me,null,{default:o(()=>[l(He,{ref_key:"form",ref:D,modelValue:m.value,"onUpdate:modelValue":t[14]||(t[14]=n=>m.value=n),onSubmit:_e(z,["prevent"])},{default:o(()=>[l(Je,null,{default:o(()=>[l(N,null,{default:o(()=>[l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.name,"onUpdate:modelValue":t[1]||(t[1]=n=>s.name=n),rules:f.name,label:"土地開發區名稱",required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.county,"onUpdate:modelValue":t[2]||(t[2]=n=>s.county=n),label:"縣市",required:"",rules:f.required,variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.township,"onUpdate:modelValue":t[3]||(t[3]=n=>s.township=n),label:"鄉鎮市區",required:"",rules:f.required,variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.method,"onUpdate:modelValue":t[4]||(t[4]=n=>s.method=n),label:"開發方式",required:"",rules:f.required,variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(Ye,{modelValue:s.status,"onUpdate:modelValue":t[5]||(t[5]=n=>s.status=n),items:T,label:"狀態",required:"",rules:f.required,variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.area,"onUpdate:modelValue":t[6]||(t[6]=n=>s.area=n),label:"面積 (公頃)",required:"",rules:f.number,variant:"outlined",type:"number",step:"0.1"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.timeline,"onUpdate:modelValue":t[7]||(t[7]=n=>s.timeline=n),label:"時程",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.organizer,"onUpdate:modelValue":t[8]||(t[8]=n=>s.organizer=n),label:"主辦單位",required:"",rules:f.required,variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.coordinates[0],"onUpdate:modelValue":t[9]||(t[9]=n=>s.coordinates[0]=n),label:"經度",type:"number",step:"0.0001",rules:f.number,variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(v,{cols:"12",md:"6"},{default:o(()=>[l(y,{modelValue:s.coordinates[1],"onUpdate:modelValue":t[10]||(t[10]=n=>s.coordinates[1]=n),label:"緯度",type:"number",step:"0.0001",rules:f.number,variant:"outlined"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(Ne,{class:"my-4"}),l(N,null,{default:o(()=>[l(v,{cols:"12"},{default:o(()=>[t[16]||(t[16]=ae("h3",{class:"text-h6 mb-3"}," 檔案管理 ",-1)),s.files&&s.files.length>0?(U(),J(Ee,{key:0},{default:o(()=>[(U(!0),le(j,null,Ue(s.files,(n,k)=>(U(),J(je,{key:k},{prepend:o(()=>[l(me,{icon:"mdi-file-pdf-box",color:"error",class:"mr-2"})]),append:o(()=>[l(B,{icon:"mdi-delete",variant:"text",density:"compact",color:"error",onClick:b=>A(k)},null,8,["onClick"])]),default:o(()=>[l(Oe,null,{default:o(()=>[F(H(n.name),1)]),_:2},1024),l(Ge,null,{default:o(()=>[F(H(n.size),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(U(),J(Il,{key:1,type:"info",text:"尚未上傳任何檔案",class:"mb-4"})),l(N,{class:"mt-2"},{default:o(()=>[l(v,{cols:"12",md:"8"},{default:o(()=>[l(y,{modelValue:d.name,"onUpdate:modelValue":t[11]||(t[11]=n=>d.name=n),label:"檔案顯示名稱",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),l(v,{cols:"12",md:"4"},{default:o(()=>[l(xl,{modelValue:d.file,"onUpdate:modelValue":t[12]||(t[12]=n=>d.file=n),label:"上傳PDF檔",variant:"outlined",accept:"application/pdf","hide-details":"",density:"compact","prepend-icon":"","prepend-inner-icon":"mdi-paperclip"},null,8,["modelValue"])]),_:1})]),_:1}),ae("div",Dl,[l(B,{color:"primary",variant:"outlined","prepend-icon":"mdi-plus",disabled:!d.file||!d.name,onClick:w},{default:o(()=>t[15]||(t[15]=[F(" 新增檔案 ")])),_:1},8,["disabled"])])]),_:1})]),_:1}),l(N,null,{default:o(()=>[l(v,{cols:"12",class:"d-flex justify-end"},{default:o(()=>[l(B,{variant:"outlined",color:"grey",class:"mr-2",onClick:t[13]||(t[13]=n=>te(I).back())},{default:o(()=>t[17]||(t[17]=[F(" 取消 ")])),_:1}),l(B,{color:"primary",type:"submit",loading:p.value},{default:o(()=>t[18]||(t[18]=[F(" 儲存 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}},El=he(zl,[["__scopeId","data-v-79eb2ee1"]]);export{El as default};
