import{a as $}from"./NcfOxGOJ.js";import{t as B,I as y,a as q}from"./DYcbPNs3.js";import{c as z,e as J}from"./DGB6o809.js";import{s as S,g as p,I as K}from"./D391rXv1.js";import{B as Z}from"./BBoprNr9.js";import{c as j}from"./CBsAYBMq.js";import{I as U}from"./CKUT-AdB.js";import Q from"./MGqbFZfO.js";import Y from"./DO_F0CpN.js";const De="ol-hidden",Se="ol-unselectable",ke="ol-control",Ie="ol-collapsed",X=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),H=["style","variant","weight","size","lineHeight","family"],N=function(i){const e=i.match(X);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let s=0,n=H.length;s<n;++s){const r=e[s+1];r!==void 0&&(t[H[s]]=r)}return t.families=t.family.split(/,\s?/),t};function P(i){return i?Array.isArray(i)?B(i):typeof i=="object"&&"src"in i?ee(i):i:null}function ee(i){if(!i.offset||!i.size)return S.getPattern(i.src,"anonymous",i.color);const e=i.src+":"+i.offset,t=S.getPattern(e,void 0,i.color);if(t)return t;const s=S.get(i.src,"anonymous",null);if(s.getImageState()!==y.LOADED)return null;const n=z(i.size[0],i.size[1]);return n.drawImage(s.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),p(n.canvas,e,void 0,y.LOADED,i.color,!0),S.getPattern(e,void 0,i.color)}const ze="10px sans-serif",W="#000",E="round",Ce=[],Ae=0,T="round",te=10,ie="#000",Le="center",we="middle",Me=[0,0,0,0],se=1,_=new Z;let D=null,M;const v={},ve=function(){const e="32px ",t=["monospace","serif"],s=t.length,n="wmytzilWMYTZIL@#/&?$%10";let r,h;function u(a,l,d){let c=!0;for(let f=0;f<s;++f){const g=t[f];if(h=C(a+" "+l+" "+e+g,n),d!=g){const m=C(a+" "+l+" "+e+d+","+g,n);c=c&&m!=h}}return!!c}function o(){let a=!0;const l=_.getKeys();for(let d=0,c=l.length;d<c;++d){const f=l[d];if(_.get(f)<100){const[g,m,k]=f.split(`
`);u(g,m,k)?(j(v),D=null,M=void 0,_.set(f,100)):(_.set(f,_.get(f)+1,!0),a=!1)}}a&&(clearInterval(r),r=void 0)}return function(a){const l=N(a);if(!l)return;const d=l.families;for(let c=0,f=d.length;c<f;++c){const g=d[c],m=l.style+`
`+l.weight+`
`+g;_.get(m)===void 0&&(_.set(m,100,!0),u(l.style,l.weight,g)||(_.set(m,0,!0),r===void 0&&(r=setInterval(o,32))))}}}(),ne=function(){let i;return function(e){let t=v[e];if(t==null){if(J){const s=N(e),n=V(e,"Žg");t=(isNaN(Number(s.lineHeight))?1.2:Number(s.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=e,document.body.appendChild(i),t=i.offsetHeight,document.body.removeChild(i);v[e]=t}return t}}();function V(i,e){return D||(D=z(1,1)),i!=M&&(D.font=i,M=D.font),D.measureText(e)}function C(i,e){return V(i,e).width}function Fe(i,e,t){if(e in t)return t[e];const s=e.split(`
`).reduce((n,r)=>Math.max(n,C(i,r)),0);return t[e]=s,s}function Re(i,e){const t=[],s=[],n=[];let r=0,h=0,u=0,o=0;for(let a=0,l=e.length;a<=l;a+=2){const d=e[a];if(d===`
`||a===l){r=Math.max(r,h),n.push(h),h=0,u+=o,o=0;continue}const c=e[a+1]||i.font,f=C(c,d);t.push(f),h+=f;const g=ne(c);s.push(g),o=Math.max(o,g)}return{width:r,height:u,widths:t,heights:s,lineWidths:n}}function be(i,e,t,s,n,r,h,u,o,a,l){i.save(),t!==1&&(i.globalAlpha===void 0?i.globalAlpha=d=>d.globalAlpha*=t:i.globalAlpha*=t),e&&i.transform.apply(i,e),s.contextInstructions?(i.translate(o,a),i.scale(l[0],l[1]),re(s,i)):l[0]<0||l[1]<0?(i.translate(o,a),i.scale(l[0],l[1]),i.drawImage(s,n,r,h,u,0,0,h,u)):i.drawImage(s,n,r,h,u,o,a,h*l[0],u*l[1]),i.restore()}function re(i,e){const t=i.contextInstructions;for(let s=0,n=t.length;s<n;s+=2)Array.isArray(t[s+1])?e[t[s]].apply(e,t[s+1]):e[t[s]]=t[s+1]}class F extends U{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?y.LOADING:y.LOADED,this.imageState_===y.LOADING&&this.ready().then(()=>this.imageState_=y.LOADED),this.render()}clone(){const e=this.getScale(),t=new F({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),s=this.getScaleArray();return[e[0]/2-t[0]/s[0],e[1]/2+t[1]/s[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){var r,h;const t=(r=this.fill_)==null?void 0:r.getKey(),s=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let n=(h=S.get(s,null,null))==null?void 0:h.getImage(1);if(!n){const u=this.renderOptions_,o=Math.ceil(u.size*e),a=z(o,o);this.draw_(u,a,e),n=a.canvas,S.set(s,null,null,new K(n,void 0,null,y.LOADED,null))}return n}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,s){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let n=this.radius,r=this.radius2_===void 0?n:this.radius2_;if(n<r){const L=n;n=r,r=L}const h=this.radius2_===void 0?this.points_:this.points_*2,u=2*Math.PI/h,o=r*Math.sin(u),a=Math.sqrt(r*r-o*o),l=n-a,d=Math.sqrt(o*o+l*l),c=d/o;if(e==="miter"&&c<=s)return c*t;const f=t/2/c,g=t/2*(l/d),k=Math.sqrt((n+f)*(n+f)+g*g)-n;if(this.radius2_===void 0||e==="bevel")return k*2;const I=n*Math.sin(u),G=Math.sqrt(n*n-I*I),b=r-G,x=Math.sqrt(I*I+b*b)/I;if(x<=s){const L=x*t/2-r-n;return 2*Math.max(k,L)}return k*2}createRenderOptions(){let e=E,t=T,s=0,n=null,r=0,h,u=0;this.stroke_&&(h=P(this.stroke_.getColor()??ie),u=this.stroke_.getWidth()??se,n=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??T,e=this.stroke_.getLineCap()??E,s=this.stroke_.getMiterLimit()??te);const o=this.calculateLineJoinSize_(t,u,s),a=Math.max(this.radius,this.radius2_||0),l=Math.ceil(2*a+o);return{strokeStyle:h,strokeWidth:u,size:l,lineCap:e,lineDash:n,lineDashOffset:r,lineJoin:t,miterLimit:s}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,s){if(t.scale(s,s),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let n=this.fill_.getColor();n===null&&(n=W),t.fillStyle=P(n),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let s=this.fill_.getColor(),n=0;typeof s=="string"&&(s=q(s)),s===null?n=1:Array.isArray(s)&&(n=s.length===4?s[3]:1),n===0&&(t=z(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const s=this.radius;if(t===1/0)e.arc(0,0,s,0,2*Math.PI);else{const n=this.radius2_===void 0?s:this.radius2_;this.radius2_!==void 0&&(t*=2);const r=this.angle_-Math.PI/2,h=2*Math.PI/t;for(let u=0;u<t;u++){const o=r+u*h,a=u%2===0?s:n;e.lineTo(a*Math.cos(o),a*Math.sin(o))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=W,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class R extends F{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new R({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class A{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=O,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new A({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=O,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function le(i){let e;if(typeof i=="function")e=i;else{let t;Array.isArray(i)?t=i:($(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[i]),e=function(){return t}}return e}let w=null;function ae(i,e){if(!w){const t=new Q({color:"rgba(255,255,255,0.4)"}),s=new Y({color:"#3399CC",width:1.25});w=[new A({image:new R({fill:t,stroke:s,radius:5}),fill:t,stroke:s})]}return w}function O(i){return i.getGeometry()}const xe=Object.freeze(Object.defineProperty({__proto__:null,createDefaultStyle:ae,default:A,toFunction:le},Symbol.toStringTag,{value:"Module"}));export{Se as C,F as R,A as S,ke as a,Ie as b,De as c,_ as d,P as e,E as f,Ce as g,Ae as h,T as i,se as j,te as k,W as l,ie as m,Me as n,we as o,Le as p,ze as q,ve as r,Re as s,be as t,Fe as u,R as v,ae as w,le as x,xe as y};
