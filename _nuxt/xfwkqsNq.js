var s=Object.defineProperty;var i=(e,t,a)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var n=(e,t,a)=>i(e,typeof t!="symbol"?t+"":t,a);import{ag as m}from"./CtiptTIU.js";const r={sub:1,name:"系統管理員",email:"admin@yilan.gov.tw",permissions:["land_development_manage","parameters_manage","users_manage"]};class o{constructor(t){n(this,"sub");n(this,"name");n(this,"email");n(this,"permissions");Object.assign(this,t)}}const h=m("adminAuthStore",{state:()=>({jwtToken:"",adminData:null}),actions:{setToken(e){this.jwtToken=e,localStorage.setItem("jwt",e),this.adminData=new o(r)},clearToken(){this.jwtToken="",this.adminData=null,localStorage.removeItem("jwt")},refreshUserInfo(){return this.jwtToken?(this.adminData=new o(r),Promise.resolve(this.adminData)):Promise.resolve(null)},login(e,t){try{if(e==="admin@yilan.gov.tw"&&t==="admin123"){const a="fake-jwt-token-"+Date.now();return this.setToken(a),Promise.resolve(!0)}else throw new Error("帳號或密碼錯誤")}catch(a){throw this.clearToken(),a}},logout(){this.clearToken()},changePassword(e,t,a){if(t!==a)throw new Error("新密碼與確認密碼不符");return Promise.resolve()},initFromStorage(){const e=localStorage.getItem("jwt");e&&(this.jwtToken=e,this.adminData=new o(r))}},getters:{isAuthenticated:e=>!!e.jwtToken&&!!e.adminData,hasPermission:e=>t=>{var a;return((a=e.adminData)==null?void 0:a.permissions.includes(t))??!1}}});export{o as AdminData,h as useAdminAuthStore};
