import{D as ue,E as se,F as ie,j as k,r as V,O as de,a0 as ce,o as Z,Q as C,e as fe,R as me,z as t,L as z,T as D,a1 as ve,a2 as xe,S as E,a3 as L,a4 as Ve,a5 as ge,U as ye,V as we,t as pe,A as s,W as ke,X as Ce,v as he,B as H,Y as Q,y as be,Z as Fe}from"./D0UG6bZz.js";import{u as Pe}from"./BUYRWAkO.js";import{V as Ie,a as Re,b as Se}from"./BgYkF0es.js";import{V as G}from"./RquQ-slm.js";import{V as Te}from"./CCzQCRnO.js";import{V as _e}from"./CEkwgJIC.js";import{V as W,a as T}from"./B0NSncsH.js";import{u as Be,V as X,a as Y,m as Me,b as Ne,c as Ue,d as Ae,e as ze}from"./CRkk4VS1.js";import{f as De}from"./CTPaVv7G.js";import{I as Ee}from"./CSi8b4_d.js";import{d as He}from"./CLZtlTzD.js";import"./UBcuvIsH.js";import"./CFD_vZoV.js";const Ge=se({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Ne(),...Me()},"VTextarea"),Oe=ue()({name:"VTextarea",directives:{Intersect:Ee},inheritAttrs:!1,props:Ge(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,_){let{attrs:g,emit:h,slots:d}=_;const n=ie(e,"modelValue"),{isFocused:m,focus:y,blur:b}=Be(e),B=k(()=>typeof e.counterValue=="function"?e.counterValue(n.value):(n.value||"").toString().length),F=k(()=>{if(g.maxlength)return g.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function c(a,i){var u,f;!e.autofocus||!a||(f=(u=i[0].target)==null?void 0:u.focus)==null||f.call(u)}const P=V(),l=V(),o=de(""),r=V(),J=k(()=>e.persistentPlaceholder||m.value||e.active);function M(){var a;r.value!==document.activeElement&&((a=r.value)==null||a.focus()),m.value||y()}function K(a){M(),h("click:control",a)}function ee(a){h("mousedown:control",a)}function te(a){a.stopPropagation(),M(),D(()=>{n.value="",ye(e["onClick:clear"],a)})}function ae(a){var u;const i=a.target;if(n.value=i.value,(u=e.modelModifiers)!=null&&u.trim){const f=[i.selectionStart,i.selectionEnd];D(()=>{i.selectionStart=f[0],i.selectionEnd=f[1]})}}const w=V(),I=V(Number(e.rows)),N=k(()=>["plain","underlined"].includes(e.variant));ce(()=>{e.autoGrow||(I.value=Number(e.rows))});function p(){e.autoGrow&&D(()=>{if(!w.value||!l.value)return;const a=getComputedStyle(w.value),i=getComputedStyle(l.value.$el),u=parseFloat(a.getPropertyValue("--v-field-padding-top"))+parseFloat(a.getPropertyValue("--v-input-padding-top"))+parseFloat(a.getPropertyValue("--v-field-padding-bottom")),f=w.value.scrollHeight,R=parseFloat(a.lineHeight),U=Math.max(parseFloat(e.rows)*R+u,parseFloat(i.getPropertyValue("--v-input-control-height"))),A=parseFloat(e.maxRows)*R+u||1/0,x=xe(f??0,U,A);I.value=Math.floor((x-u)/R),o.value=ve(x)})}Z(p),C(n,p),C(()=>e.rows,p),C(()=>e.maxRows,p),C(()=>e.density,p);let v;return C(w,a=>{a?(v=new ResizeObserver(p),v.observe(w.value)):v==null||v.disconnect()}),fe(()=>{v==null||v.disconnect()}),He(()=>{const a=!!(d.counter||e.counter||e.counterValue),i=!!(a||d.details),[u,f]=me(g),{modelValue:R,...U}=X.filterProps(e),A=Y.filterProps(e);return t(X,z({ref:P,modelValue:n.value,"onUpdate:modelValue":x=>n.value=x,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":N.value},e.class],style:e.style},u,U,{centerAffix:I.value===1&&!N.value,focused:m.value}),{...d,default:x=>{let{id:S,isDisabled:O,isDirty:j,isReadonly:le,isValid:oe}=x;return t(Y,z({ref:l,style:{"--v-textarea-control-height":o.value},onClick:K,onMousedown:ee,"onClick:clear":te,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},A,{id:S.value,active:J.value||j.value,centerAffix:I.value===1&&!N.value,dirty:j.value||e.dirty,disabled:O.value,focused:m.value,error:oe.value===!1}),{...d,default:ne=>{let{props:{class:$,...q}}=ne;return t(E,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),L(t("textarea",z({ref:r,class:$,value:n.value,onInput:ae,autofocus:e.autofocus,readonly:le.value,disabled:O.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:M,onBlur:b},q,f),null),[[Ve("intersect"),{handler:c},null,{once:!0}]]),e.autoGrow&&L(t("textarea",{class:[$,"v-textarea__sizer"],id:`${q.id}-sizer`,"onUpdate:modelValue":re=>n.value=re,ref:w,readonly:!0,"aria-hidden":"true"},null),[[ge,n.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:i?x=>{var S;return t(E,null,[(S=d.details)==null?void 0:S.call(d,x),a&&t(E,null,[t("span",null,null),t(Ue,{active:e.persistentCounter||m.value,value:B.value,max:F.value,disabled:e.disabled},d.counter)])])}:void 0})}),De({},P,l,r)}}),at={__name:"[action]",setup(e){const _=ke(),g=Ce(),{showSuccess:h}=Pe(),d=k(()=>_.params.id),n=k(()=>!!d.value),m=V(!1),y=V(!1),b=V(null),B=[{text:"啟用",value:!0},{text:"停用",value:!1}],F={employeeId:[l=>!!l||"請輸入員工編號",l=>l&&l.length<=20||"員工編號不可超過20個字元"],remark:[l=>!!l||"請輸入備註內容"]},c=we({employeeId:"",remark:"",status:!0}),P=async()=>{if(b.value.validate()){y.value=!0;try{await new Promise(l=>setTimeout(l,500)),h(n.value?"成功更新權限資料":"成功新增權限資料"),g.push("/admin/permissions")}catch(l){console.error("儲存失敗",l)}finally{y.value=!1}}};return Z(async()=>{if(n.value){y.value=!0;try{await new Promise(l=>setTimeout(l,300)),Object.assign(c,{employeeId:"A001",remark:"系統管理員權限",status:!0})}catch(l){console.error("獲取資料失敗",l)}finally{y.value=!1}}}),(l,o)=>(he(),pe("div",null,[t(Ie,null,{default:s(()=>[t(Re,{class:"d-flex align-center"},{default:s(()=>[t(G,{icon:"mdi-arrow-left",variant:"text",class:"mr-2",onClick:o[0]||(o[0]=r=>Q(g).back())}),H(" "+be(n.value?"編輯權限":"新增權限"),1)]),_:1}),t(Se,null,{default:s(()=>[t(Te,{ref_key:"form",ref:b,modelValue:m.value,"onUpdate:modelValue":o[5]||(o[5]=r=>m.value=r),onSubmit:Fe(P,["prevent"])},{default:s(()=>[t(_e,null,{default:s(()=>[t(W,null,{default:s(()=>[t(T,{cols:"12",md:"6"},{default:s(()=>[t(Ae,{modelValue:c.employeeId,"onUpdate:modelValue":o[1]||(o[1]=r=>c.employeeId=r),rules:F.employeeId,label:"員工編號",required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(T,{cols:"12",md:"6"},{default:s(()=>[t(ze,{modelValue:c.status,"onUpdate:modelValue":o[2]||(o[2]=r=>c.status=r),items:B,"item-title":"text","item-value":"value",label:"狀態",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(T,{cols:"12"},{default:s(()=>[t(Oe,{modelValue:c.remark,"onUpdate:modelValue":o[3]||(o[3]=r=>c.remark=r),rules:F.remark,label:"備註",required:"",variant:"outlined",rows:"3"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(W,null,{default:s(()=>[t(T,{cols:"12",class:"d-flex justify-end"},{default:s(()=>[t(G,{variant:"outlined",color:"grey",class:"mr-2",onClick:o[4]||(o[4]=r=>Q(g).back())},{default:s(()=>o[6]||(o[6]=[H(" 取消 ")])),_:1}),t(G,{color:"primary",type:"submit",loading:y.value},{default:s(()=>o[7]||(o[7]=[H(" 儲存 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}};export{at as default};
